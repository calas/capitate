#
# This file is auto-generated from Capgen
#

set :application, <%= config.application %>
set :repository, <%= config.repository %>
set :user, <%= config.user %>
set :bootstrap_user, Proc.new { Capistrano::CLI.ui.ask('Bootstrap user: ') }

set :deploy_via, :copy
set :copy_strategy, :export

# If you aren't deploying to /u/apps/#{application} on the target
# servers (which is the default), you can specify the actual location
# via the :deploy_to variable:
set :deploy_to, <%= config.deploy_to %>

# If you aren't using Subversion to manage your source code, specify
# your SCM below:
# set :scm, :subversion

role :web, <%= config.web_host %>
role :db,  <%= config.db_host %>, :primary => true

# How many releases to keep
# set :keep_releases, 3

#
# Other variables accessible in recipes
#

set :db_user, <%= config.db_user %>
set :db_pass, <%= config.db_pass %>
set :db_name, <%= config.db_name %>
set :db_host, <%= config.db_host %>
set :db_port, <%= config.db_port %>

set :mongrel_port, <%= config.mongrel_port %>
set :mongrel_size, <%= config.mongrel_size %>
set :domain_name, <%= config.domain_name %>
set :web_host, <%= config.web_host %>
set :db_host, <%= config.db_host %>

set :mysql_admin_password, Proc.new { Capistrano::CLI.ui.ask('Mysql admin password: ') }

#
# Callbacks
#

<% config.recipes["before_setup"].each do |recipe| %>
  before "deploy:setup", <%= recipe %>
<% end %>

<% config.recipes["after_setup"].each do |recipe| %>
  after "deploy:setup", <%= recipe %>
<% end %>

<% config.recipes["after_update_code"].each do |recipe| %>
  after "deploy:update_code", <%= recipe %>
<% end %>

# Auto cleanup after deploy?
after "deploy", "deploy:cleanup"