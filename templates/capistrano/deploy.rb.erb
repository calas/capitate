#
# This file is auto-generated from Capgen
#

set :application, "<%= application %>"
set :repository, "<%= repository %>"
set :user, "<%= user %>"
set :bootstrap_user, Proc.new { Capistrano::CLI.ui.ask('Bootstrap user: ') }

set :deploy_via, :copy
set :copy_strategy, :export

# If you aren't deploying to /u/apps/#{application} on the target
# servers (which is the default), you can specify the actual location
# via the :deploy_to variable:
set :deploy_to, "<%= deploy_to %>"

# If you aren't using Subversion to manage your source code, specify
# your SCM below:
# set :scm, :subversion

role :web, "<%= web_host %>", :primary => true
role :db,  "<%= db_host %>"

# How many releases to keep
# set :keep_releases, 3

#
# Other variables accessible in recipes
#

set :db_user, "<%= db_user %>"
set :db_pass, "<%= db_pass %>"
set :db_name, "<%= db_name %>"
set :db_host, "<%= db_host %>"
set :db_port, "<%= db_port %>"
set :sphinx_host, "<%= sphinx_host %>"
set :sphinx_port, "<%= sphinx_port %>"

set :mongrel_port, "<%= mongrel_port %>"
set :mongrel_size, "<%= mongrel_size %>"
set :domain_name, "<%= domain_name %>"
set :web_host, "<%= web_host %>"
set :db_host, "<%= db_host %>"

set :mysql_admin_password, Proc.new { Capistrano::CLI.ui.ask('Mysql admin password: ') }

#
# Callbacks
#
<% recipes["before_setup"].each do |recipe| %>
before "deploy:setup", "<%= recipe %>"<% end %>

<% recipes["after_setup"].each do |recipe| %>
after "deploy:setup", "<%= recipe %>"<% end %>

<% recipes["after_update_code"].each do |recipe| %>
after "deploy:update_code", "<%= recipe %>"<% end %>

# Auto cleanup after deploy?
after "deploy", "deploy:cleanup"